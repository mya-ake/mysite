{"title":"CSS フレームワークを Vue.js のコンポーネントにする方法","description":"","body":"<h2 id=\"この記事について\">この記事について</h2><p>この記事は<a href=\"https://qiita.com/advent-calendar/2018/vuejs-2\">Vue.js #2 Advent Calendar 2018 - Qiita</a>の 20 日目の記事です。</p>\n<p>この記事では Google が提供しているマテリアルデザインの CSS フレームワークである<a href=\"https://material.io/develop/web/\">Material Components</a>を Vue.js のコンポーネントにしていく話を書いています。</p>\n<p>その過程で Vue.js におけるコンポーネントを作るときの要点なども一緒に書いてます。</p>\n<h3 id=\"バージョンなど\">バージョンなど</h3><ul>\n<li>Vue.js: 2.5.21</li>\n<li>Vue CLI: 3.2.1</li>\n<li>Material Components: 0.42.x</li>\n</ul>\n<h2 id=\"アウトライン\">アウトライン</h2><ul>\n<li>Material Components</li>\n<li>今回作るもの</li>\n<li>Material Components をプロジェクトに導入する</li>\n<li>Button のコンポーネント</li>\n<li>Text Field のコンポーネント</li>\n<li>まとめ</li>\n<li>補足<ul>\n<li>どのような CSS フレームワークならコンポーネント化することができるのか</li>\n<li>コンポーネント化したライブラリはすでに存在する</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"Material_Components\">Material Components</h2><p>冒頭にも書きましたが Material Components は Google が提供しているフレームワークです。\nweb だけでなく Android / iOS / Flutter 向けにも提供されています。\nマテリアルデザインの提唱者である Google 自身が作っているので、ガイドラインに準拠した見た目のコンポーネントを作っていくことができます。</p>\n<p><a href=\"https://material.io/develop/\">Develop - Material Design</a></p>\n<p>具体的にどのようなコンポーネントが提供されているのかはサイト上にカタログページがるのでそちらを見るとよいでしょう。</p>\n<p><a href=\"https://material-components.github.io/material-components-web-catalog/\">Material Components Web | Catalog</a></p>\n<h2 id=\"今回作るもの\">今回作るもの</h2><p>今回は Button と Text Field を取り上げます。\n次の画像のような検索のコンポーネントっぽいものを作ります。</p>\n<p>フォーカスするとプレースホルダーになっていたテキストが左上に移動するかっこいいアニメーション付きのやつです。</p>\n<p><img src=\"/images/vuejs-component-with-css-framework/no-input.png\" alt=\"text fieldとbuttonの組み合わせ（入力なし）\" style=\"max-width: 320px; margin: 0 auto;\"></p>\n<p><img src=\"/images/vuejs-component-with-css-framework/input.png\" alt=\"text fieldとbuttonの組み合わせ（入力あり）\" style=\"max-width: 320px; margin: 0 auto;\"></p>\n<h2 id=\"Material_Components_をプロジェクトに導入する\">Material Components をプロジェクトに導入する</h2><p>導入に関してはサイトの<a href=\"https://material.io/develop/web/docs/getting-started/\">Getting Started</a>のページに書かれています。</p>\n<p>今回は Vue CLI v3 で作成したプロジェクトに Material Components を導入するための最低限の方法を紹介します。</p>\n<h3 id=\"インストール\">インストール</h3><p>Material Components はコンポーネント単位でインストールできます。</p>\n<p>今回使うのは Button と Text Field だけなので 2 つだけインストールします。</p>\n<pre><code class=\"hljs lang-bash\"><span class=\"hljs-variable\">$ </span>yarn add <span class=\"hljs-variable\">@material</span>/button <span class=\"hljs-variable\">@material</span>/textfield\n</code></pre>\n<h3 id=\"SASS\">SASS</h3><p>Material Components は SASS で書かれています。\nそのため SASS のファイルを直接 style ブロックで読み込むことで Vue.js のコンポーネントにスタイルを当てることができます。</p>\n<p>style ブロックで読み込むために<code>vue.config.js</code>で SASS の includePaths の設定をします。</p>\n<p>Vue CLI で作成たプロジェクトは<a href=\"https://cli.vuejs.org/config/#css-loaderoptions\">css.loaderOptions</a>を使い各 loader の設定を拡張できます。\n今回は includePaths の設定のついでに SASS の変数ファイルを style ブロックで自動的に読み込んでくれるようにもしています。</p>\n<pre><code class=\"hljs lang-JavaScript\"><span class=\"hljs-keyword\">const</span> path = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">'path'</span>);\n\n<span class=\"hljs-keyword\">const</span> SRC_DIR = path.resolve(__dirname, <span class=\"hljs-string\">'src'</span>);\n<span class=\"hljs-keyword\">const</span> SCSS_DIR = path.join(SRC_DIR, <span class=\"hljs-string\">'assets'</span>, <span class=\"hljs-string\">'scss'</span>);\n\n<span class=\"hljs-keyword\">const</span> SASS_AUTO_IMPORTS = <span class=\"hljs-string\">`\n@import \"<span class=\"hljs-subst\">${path.join(SCSS_DIR, <span class=\"hljs-string\">'_variables.scss'</span>)}</span>\";\n`</span>;\n\n<span class=\"hljs-built_in\">module</span>.exports = {\n  <span class=\"hljs-attr\">css</span>: {\n    <span class=\"hljs-attr\">loaderOptions</span>: {\n      <span class=\"hljs-attr\">sass</span>: {\n        <span class=\"hljs-attr\">data</span>: SASS_AUTO_IMPORTS,\n        <span class=\"hljs-attr\">includePaths</span>: [<span class=\"hljs-string\">'./node_modules'</span>],\n      },\n    },\n  },\n};\n</code></pre>\n<p>以上がプロジェクトで Material Components を使う準備です。</p>\n<h2 id=\"Button_のコンポーネント\">Button のコンポーネント</h2><p>早速 Button のコンポーネントとなる BaseButton コンポーネントを作ります。\nコンポーネント単位の使い方はドキュメントにまとめられています。</p>\n<p><a href=\"https://material.io/develop/web/components/buttons/\">Buttons - Material Components for the Web</a></p>\n<p>簡単な流れとしては次のような感じです。</p>\n<ol>\n<li>HTML マークアップ（template ブロック）</li>\n<li>SASS 読み込み（style ブロック）</li>\n<li>必要であれば JavaScript 読み込み（script ブロック）</li>\n</ol>\n<p>先に完成したコードを載せて、その後に次の点にフォーカスを当てて解説します。</p>\n<ul>\n<li>見た目のバリエーション</li>\n<li>ライフサイクルに合わせた初期化と破棄</li>\n<li>見た目のカスタマイズ</li>\n</ul>\n<pre><code class=\"hljs lang-HTML\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">template</span>&gt;</span>\n  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">button</span>\n    <span class=\"hljs-attr\">ref</span>=<span class=\"hljs-string\">\"button\"</span>\n    <span class=\"hljs-attr\">:type</span>=<span class=\"hljs-string\">\"type\"</span>\n    <span class=\"hljs-attr\">:class</span>=<span class=\"hljs-string\">\"{\n      'mdc-button--raised': raised,\n      'base-button--raised': raised,\n      'mdc-button--unelevated': unelevated,\n      'base-button--unelevated': unelevated,\n      'mdc-button--outlined': outlined,\n      'base-button--outlined': outlined,\n    }\"</span>\n    <span class=\"hljs-attr\">class</span>=<span class=\"hljs-string\">\"mdc-button base-button\"</span>\n    @<span class=\"hljs-attr\">click</span>=<span class=\"hljs-string\">\"handleClick\"</span>\n  &gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">slot</span> /&gt;</span>\n  <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">button</span>&gt;</span>\n<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">template</span>&gt;</span>\n\n<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">script</span>&gt;</span><span class=\"javascript\">\n<span class=\"hljs-keyword\">import</span> { MDCRipple } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">'@material/ripple'</span>;\n\n<span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">default</span> {\n  <span class=\"hljs-attr\">name</span>: <span class=\"hljs-string\">'BaseButton'</span>,\n\n  <span class=\"hljs-attr\">props</span>: {\n    <span class=\"hljs-attr\">type</span>: {\n      <span class=\"hljs-attr\">type</span>: <span class=\"hljs-built_in\">String</span>,\n      <span class=\"hljs-attr\">default</span>: <span class=\"hljs-string\">'button'</span>,\n    },\n\n    <span class=\"hljs-attr\">raised</span>: {\n      <span class=\"hljs-attr\">type</span>: <span class=\"hljs-built_in\">Boolean</span>,\n      <span class=\"hljs-attr\">default</span>: <span class=\"hljs-literal\">false</span>,\n    },\n\n    <span class=\"hljs-attr\">unelevated</span>: {\n      <span class=\"hljs-attr\">type</span>: <span class=\"hljs-built_in\">Boolean</span>,\n      <span class=\"hljs-attr\">default</span>: <span class=\"hljs-literal\">false</span>,\n    },\n\n    <span class=\"hljs-attr\">outlined</span>: {\n      <span class=\"hljs-attr\">type</span>: <span class=\"hljs-built_in\">Boolean</span>,\n      <span class=\"hljs-attr\">default</span>: <span class=\"hljs-literal\">false</span>,\n    },\n  },\n\n  data() {\n    <span class=\"hljs-keyword\">return</span> {\n      <span class=\"hljs-attr\">mdc</span>: <span class=\"hljs-literal\">null</span>,\n    };\n  },\n\n  mounted() {\n    <span class=\"hljs-keyword\">this</span>.initializeMDC();\n  },\n\n  beforeDestroy() {\n    <span class=\"hljs-keyword\">this</span>.destroyMDC();\n  },\n\n  <span class=\"hljs-attr\">methods</span>: {\n    initializeMDC() {\n      <span class=\"hljs-keyword\">this</span>.mdc = MDCRipple.attachTo(<span class=\"hljs-keyword\">this</span>.$refs.button);\n    },\n\n    destroyMDC() {\n      <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-keyword\">this</span>.mdc !== <span class=\"hljs-literal\">null</span>) {\n        <span class=\"hljs-keyword\">this</span>.mdc.destroy();\n      }\n    },\n\n    handleClick(evt) {\n      <span class=\"hljs-keyword\">this</span>.$emit(<span class=\"hljs-string\">'click'</span>, evt);\n    },\n  },\n};\n</span><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">script</span>&gt;</span>\n\n<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">style</span> <span class=\"hljs-attr\">lang</span>=<span class=\"hljs-string\">\"scss\"</span> <span class=\"hljs-attr\">scoped</span>&gt;</span><span class=\"undefined\">\n@import '@material/button/mdc-button';\n\n.base-button {\n  @include mdc-button-ink-color($color-vue);\n  @include mdc-states($color-vue);\n  line-height: 1;\n}\n\n.base-button--raised,\n.base-button--unelevated {\n  @include mdc-button-container-fill-color($color-vue);\n  @include mdc-button-ink-color(white);\n  @include mdc-states(white);\n}\n\n.base-button--outlined {\n  @include mdc-button-outline-color($color-vue);\n}\n</span><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">style</span>&gt;</span>\n</code></pre>\n<h3 id=\"見た目のバリエーション\">見た目のバリエーション</h3><p>Button コンポーネントにはいくつかの<a href=\"https://material.io/develop/web/components/buttons/#style-customization\">バリエーション</a>が存在します。</p>\n<p>今回は次の 3 つのバリエーションに対応させています。</p>\n<ul>\n<li>raised</li>\n<li>unelevated</li>\n<li>outlined</li>\n</ul>\n<p>Material Components は BEM で書かれており、バリエーションは <code>mdc-button--raised</code> のようなクラスで提供されています。\nこのバリエーションのクラスを props の値によって切り替わるようにします。</p>\n<p>props は <code>type: Boolean</code> でバリエーションと同じ名前のものを記述します。\nBoolean を指定することで次のように属性に props 名と同じ属性を指定すると true に props を作れます。</p>\n<pre><code class=\"hljs \"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">BaseButton</span> <span class=\"hljs-attr\">raised</span>&gt;</span>浮き上がったボタン<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">BaseButton</span>&gt;</span>\n</code></pre><p>props には boolean の値がくるようになったので、後は class 属性をバインドさせて、クラスの出し分けをするだけでバリエーションに対応できます。\nclass 属性は Object をバインドさせると、値が truthy のときにそのプロパティ名のクラスが有効になります。</p>\n<h3 id=\"ライフサイクルに合わせた初期化と破棄\">ライフサイクルに合わせた初期化と破棄</h3><p>SPA のプロジェクトの場合は画面がリロードされないので、イベントの管理が重要になります。\nBaseButton ではリップル（クリックやタップしたときの波紋のようなエフェクト）をつけています。</p>\n<p>リップルは</p>\n<h3 id=\"見た目のカスタマイズ\">見た目のカスタマイズ</h3><h2 id=\"Text_Field_のコンポーネント\">Text Field のコンポーネント</h2><pre><code class=\"hljs lang-HTML\">&lt;template&gt;\n  &lt;div ref=<span class=\"hljs-string\">\"textField\"</span> <span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span>=\"<span class=\"hljs-title\">mdc</span>-<span class=\"hljs-title\">text</span>-<span class=\"hljs-title\">field</span> <span class=\"hljs-title\">base</span>-<span class=\"hljs-title\">text</span>-<span class=\"hljs-title\">field</span>\"&gt;</span>\n    &lt;input\n      :id=<span class=\"hljs-string\">\"id\"</span>\n      v-model=<span class=\"hljs-string\">\"model\"</span>\n      v-bind=<span class=\"hljs-string\">\"props\"</span>\n      <span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span>=\"<span class=\"hljs-title\">mdc</span>-<span class=\"hljs-title\">text</span>-<span class=\"hljs-title\">field__input</span>\"</span>\n    /&gt;\n    &lt;label :<span class=\"hljs-keyword\">for</span>=<span class=\"hljs-string\">\"id\"</span> <span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span>=\"<span class=\"hljs-title\">mdc</span>-<span class=\"hljs-title\">floating</span>-<span class=\"hljs-title\">label</span>\"&gt;&lt;<span class=\"hljs-type\">slot /</span>&gt;&lt;<span class=\"hljs-type\">/label</span>&gt;</span>\n    &lt;div <span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span>=\"<span class=\"hljs-title\">mdc</span>-<span class=\"hljs-title\">line</span>-<span class=\"hljs-title\">ripple</span>\" /&gt;</span>\n  &lt;/div&gt;\n&lt;/template&gt;\n\n&lt;script&gt;\n<span class=\"hljs-keyword\">import</span> { MDCTextField } from <span class=\"hljs-string\">'@material/textfield'</span>;\n<span class=\"hljs-keyword\">import</span> { vueUidMixin } from <span class=\"hljs-string\">'vue-uid'</span>;\n\nexport <span class=\"hljs-keyword\">default</span> {\n  mixins: [vueUidMixin],\n\n  inheritAttrs: <span class=\"hljs-literal\">false</span>,\n\n  props: {\n    value: {\n      type: String,\n      required: <span class=\"hljs-literal\">true</span>,\n    },\n\n    type: {\n      type: String,\n      <span class=\"hljs-keyword\">default</span>: <span class=\"hljs-string\">'text'</span>,\n    },\n  },\n\n  <span class=\"hljs-keyword\">data</span>() {\n    <span class=\"hljs-keyword\">return</span> {\n      mdc: <span class=\"hljs-literal\">null</span>,\n    };\n  },\n\n  computed: {\n    id() {\n      <span class=\"hljs-keyword\">return</span> `base-text-field-${<span class=\"hljs-keyword\">this</span>.$_uid}`;\n    },\n\n    props() {\n      <span class=\"hljs-keyword\">return</span> {\n        ...<span class=\"hljs-keyword\">this</span>.$props,\n        ...<span class=\"hljs-keyword\">this</span>.$attrs,\n      };\n    },\n\n    model: {\n      <span class=\"hljs-keyword\">set</span>(value) {\n        <span class=\"hljs-keyword\">this</span>.$emit(<span class=\"hljs-string\">'input'</span>, value);\n      },\n      <span class=\"hljs-keyword\">get</span>() {\n        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-keyword\">this</span>.value;\n      },\n    },\n  },\n\n  mounted() {\n    <span class=\"hljs-keyword\">this</span>.initializeMDC();\n  },\n\n  beforeDestroy() {\n    <span class=\"hljs-keyword\">this</span>.destroyMDC();\n  },\n\n  methods: {\n    initializeMDC() {\n      <span class=\"hljs-keyword\">this</span>.mdc = MDCTextField.attachTo(<span class=\"hljs-keyword\">this</span>.$refs.textField);\n    },\n\n    destroyMDC() {\n      <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-keyword\">this</span>.mdc !== <span class=\"hljs-literal\">null</span>) {\n        <span class=\"hljs-keyword\">this</span>.mdc.destroy();\n      }\n    },\n  },\n};\n&lt;/script&gt;\n\n&lt;style lang=<span class=\"hljs-string\">\"scss\"</span> scoped&gt;\n<span class=\"hljs-meta\">@import</span> <span class=\"hljs-string\">'@material/textfield/mdc-text-field'</span>;\n\n.base-text-field {\n  <span class=\"hljs-meta\">@include</span> mdc-text-field-label-color($color-vue);\n  <span class=\"hljs-meta\">@include</span> mdc-text-field-caret-color($color-vue);\n  <span class=\"hljs-meta\">@include</span> mdc-text-field-fill-color(transparent);\n  <span class=\"hljs-meta\">@include</span> mdc-text-field-hover-bottom-line-color($color-vue);\n  <span class=\"hljs-meta\">@include</span> mdc-text-field-line-ripple-color($color-vue);\n}\n&lt;/style&gt;\n</code></pre>\n<h2 id=\"まとめ\">まとめ</h2><h2 id=\"補足\">補足</h2><h3 id=\"コンポーネント化したライブラリはすでに存在する\">コンポーネント化したライブラリはすでに存在する</h3><h3 id=\"どのような_CSS_フレームワークならコンポーネント化することができるのか\">どのような CSS フレームワークならコンポーネント化することができるのか</h3>","thumbnail":"","twitterCardType":"","createdAt":"2018-12-20"}